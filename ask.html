<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Assistant</title>

  <!--
    PAW Tool Page: Assistant

    UI contract:
    - Shared layout classes come from paw-ui.css.
    - Shared behavior lives in tool-shell.js (Worker prompting is NOT in public files).
    - Required IDs for tool-shell.js:
        #messages, #input, #send, #reset, #tips
  -->
  <link rel="stylesheet" href="/paw-ui.css">
</head>

<body>
  <div class="app">
    <div class="frame">
      <div class="panel">

        <div class="panel-topbar">
          <div class="topbar-row0">
            <div class="tool-head">
              <div class="tool-title">Assistant</div>
              <div class="tool-subtitle">Quick answers, rewrites, and next steps.</div>
            </div>

            <div class="topbar-right">
              <div class="utility-pair" role="group" aria-label="Tool utilities">
                <button id="reset" class="util-btn" type="button">Reset</button>
                <button id="tips" class="util-btn" type="button">Tips &amp; How To</button>
              </div>
            </div>
          </div>
        </div>

        <div id="messages" class="messages"></div>

        <div class="composer">
          <textarea id="input" placeholder="How can I assist you today?"></textarea>
          <button id="send" class="send" aria-label="Send" type="button">
            <svg viewBox="0 0 24 24" fill="none">
              <path d="M12 5l7 7-1.4 1.4L13 8.8V20h-2V8.8L6.4 13.4 5 12l7-7z" fill="currentColor"/>
            </svg>
          </button>
        </div>

      </div>
    </div>
  </div>

  <script src="/tool-shell.js"></script>

  <script>
    (function () {
      // Public tools call the private Worker. Do NOT inline prompts here.
      const API_ENDPOINT = "https://paw-api.joe-b40.workers.dev";

      const DISCLAIMER_TEXT =
        "Important: This assistant provides general guidance intended to help real estate agents communicate clearly and professionally. " +
        "It is not legal advice. Local MLS rules, Fair Housing guidance, and compliance requirements vary by market — use your brokerage " +
        "and local resources for final review.";

      const DISCLAIMER_TRIGGER =
        /(fair housing|mls|compliance|legal|law|attorney|contract|offer|escrow|earnest|addendum|inspection|lien|title|short sale|agency|disclosure)/i;

      const TIPS_TEXT =
`How to use this assistant
• Ask questions in plain English
• Paste an email, text, or draft and tell me what you want it to sound like
• Use it to think through next steps, messaging, objections, or client situations

Compliance note
${DISCLAIMER_TEXT}`;

      window.PAWToolShell.init({
        toolId: "ask",
        apiEndpoint: API_ENDPOINT,

        inputPlaceholder: "How can I assist you today?",
        tipsText: TIPS_TEXT,

        enableDisclaimer: true,
        disclaimerTrigger: DISCLAIMER_TRIGGER,
        getDisclaimerText: () => DISCLAIMER_TEXT,

        // Keep the assistant focused, but allow enough context for follow-ups.
        sendHistoryItems: 10,
        maxHistoryItems: 20
      });
    })();
  </script>
</body>
</html>
