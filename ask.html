<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Assistant</title>

  <link rel="stylesheet" href="/paw-ui.css">
</head>

<body>
  <div class="app">
    <div class="frame">
      <div class="panel">

        <!-- TOP BAR (match listing tool UI) -->
        <div class="panel-topbar">
          <div class="topbar-row1">
            <div class="topbar-left">
              <div class="tool-title">Assistant</div>
            </div>
            <div class="topbar-right">
              <button id="reset" class="btn btn-ghost" type="button">Reset</button>
              <button id="tips" class="btn btn-ghost" type="button">Tips &amp; How To</button>
            </div>
          </div>
        </div>

        <!-- CONTENT -->
        <div class="panel-body">
          <div class="chat-shell">
            <div id="messages" class="messages"></div>

            <div class="composer">
              <textarea id="input" class="input" rows="5" placeholder="How can I assist you today?"></textarea>
              <button id="send" class="send" type="button" aria-label="Send">
                <span class="send-icon">↑</span>
              </button>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>

  <script src="/tool-shell.js"></script>

  <script>
    (function () {
      // IMPORTANT: Enable embed styling when iframe is loaded with ?embed=1
      try {
        const p = new URLSearchParams(location.search);
        if (p.get("embed") === "1") {
          document.documentElement.dataset.embed = "1";
        }
      } catch {}

      const API_ENDPOINT = "/api/ask";

      const TIPS_TEXT =
`What this is best for:
• Quick answers + next steps
• Rewriting texts, emails, bios, and social posts
• Talking through tricky client situations

How to get the best output:
• Paste the text you want improved
• Tell me your audience (buyer, seller, agent, lender, etc.)
• Tell me your tone (friendly, firm, confident, luxury, casual)
• Add local constraints (state, brokerage rules, MLS rules) if relevant`;

      const DISCLAIMER_TEXT =
`Important: This tool is not legal, tax, or brokerage advice.
Always confirm compliance with your local MLS rules, brokerage policies, and Fair Housing guidance.`;

      const DISCLAIMER_TRIGGER = /(fair housing|mls rule|legal|law|attorney|tax|discrimination|protected class|race|religion|gender|sexual orientation|disability|familial status|national origin|hud|ethics|fine|penalty|license|licensing|brokerage policy|commission|contract|lease|eviction|foreclosure|lien|title|short sale|agency|disclosure|compliance)/i;

      window.PAWToolShell.init({
        apiEndpoint: API_ENDPOINT,
        toolId: "", // generic assistant route
        inputPlaceholder: "How can I assist you today?",
        tipsText: TIPS_TEXT,

        enableDisclaimer: true,
        disclaimerTrigger: DISCLAIMER_TRIGGER,
        getDisclaimerText: () => DISCLAIMER_TEXT,

        sendHistoryItems: 10,
        maxHistoryItems: 20,

        deliverableMode: false
      });
    })();
  </script>
</body>
</html>
